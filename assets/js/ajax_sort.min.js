$(function(){function t(){if($(".ajax-filter-count").length){var t=$(".ajax-filter-count").data("count");$(n).text(t)}else $(n).text($(o).length)}function a(){$.ajax({data:$(s).serialize()}).done(function(a){var n=$(a);$(i).fadeOut(e),setTimeout(function(){$(i).html(n.find(i).html()).fadeIn(e),t(),$(".category_block__items-item_name").equivalent(),$(".preloader").hide(),$(".popup-content").magnificPopup({type:"inline",removalDelay:300,mainClass:"my-mfp-zoom-in"})},e)})}var e=100,n=".ajax-count",i=".ajax-container",o=".ajax-item",s=".ajax-form";t(),$(i).on("click",".ajax-more",function(t){t.preventDefault();var a=$(o).length;$.ajax({data:$(s).serialize()+"&offset="+a}).done(function(t){$(".ajax-more").remove();var a=$(t);a.find(o).hide(),$(i).append(a.find(i).html()),$(o).fadeIn(),$(".category_block__items-item_name").equivalent(),$(".preloader").hide(),$(".popup-content").magnificPopup({type:"inline",removalDelay:300,mainClass:"my-mfp-zoom-in"})})}),$(".ajax-start").click(function(t){t.preventDefault(),a()}),$(".ajax-reset").click(function(n){n.preventDefault(),$(s).trigger("reset"),$("input[name=sortby]").val("pagetitle"),$("input[name=sortdir]").val("asc"),setTimeout(function(){$("[data-sort-by]").data("sort-dir","asc").toggleClass("button-sort-asc").text("По возрастанию")},e),a(),t()}),$(s+" input").change(function(){a()}),$("[data-sort-by]").data("sort-dir","asc").click(function(){var t=$(this);$("input[name=sortby]").val($(this).data("sort-by")),$("input[name=sortdir]").val($(this).data("sort-dir")),setTimeout(function(){$("[data-sort-by]").not(this).toggleClass("button-sort-asc").text("По возрастанию"),"asc"==t.data("sort-dir")?t.data("sort-dir","desc").text("По убыванию"):t.data("sort-dir","asc").text("По возрастанию"),$(this).toggleClass("button-sort-asc")},e),a()}),$("#title_filter").keyup(function(){$(this).on("keypress",function(t){13==t.which&&t.preventDefault()}),0!==$(this).val().length?$(".search_block").addClass("searching"):$(".search_block").removeClass("searching"),a()}),$(".search_block").click(function(){$("#title_filter").val(""),$(this).removeClass("searching"),a()})})